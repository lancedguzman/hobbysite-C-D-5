{% extends "commissions/base.html" %}

{% block title %}Edit Commission{% endblock %}

{% block content %}
  <h1>Edit Commission: {{ commission.title }}</h1>

  {% if commission.author %}
    <!-- Form to update commission -->
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="update_commission" value="1">

      <label>Title:</label><br>
      <input type="text" name="title" value="{{ commission.title }}" required><br><br>

      <label>Description:</label><br>
      <textarea name="description" rows="5" cols="40" required>{{ commission.description }}</textarea><br><br>

      <label>Status:</label><br>
      <select name="status">
        {% for value, label in status_choices %}
          <option value="{{ value }}" {% if value == commission.status %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select><br><br>

      <button type="submit">Update Commission</button>
    </form>

    <hr>

  <h2>Existing Jobs</h2>
  {% if jobs %}
    <ul>
      {% for job in jobs %}
        <li>
          <strong>{{ job.role }}</strong> ({{ job.status }}) {{ job.manpower_required }} people needed
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No jobs added yet.</p>
  {% endif %}

  <hr>

  <h2>Add a Job</h2>
  <form method="post">
    {% csrf_token %}
    <input type="hidden" name="add_job" value="1">

    <label>Role:</label><br>
    <input type="text" name="role" required><br><br>

    <label>Manpower Required:</label><br>
    <input type="number" name="manpower_required" min="1" required><br><br>

    <label>Status:</label><br>
    <select name="status" required>
      <option value="Open">Open</option>
    </select><br><br>

    <button type="submit">Add Job</button>
  </form>

  {% else %}
    <p><em>This commission's author has been deleted, and the commission cannot be edited.</em></p>
  {% endif %}

  <br>
  <a href="{% url 'commissions:commission' commission.pk %}">‚Üê Back to Commission Detail</a>
{% endblock %}
