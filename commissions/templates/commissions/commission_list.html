{% extends "commissions/base.html" %}

{% block content %}
  <h1>List of Commissions</h1>

  {% if user.is_authenticated %}
    <h2>Your Commissions</h2>
    <ul>
      {% for commission in user_commissions %}
        <li>
          <a href="{% url 'commissions:commission' commission.id %}">
            {{ commission.title }}
          </a>
          - {% if commission.author %}
                Created by {{ commission.author.display_name }}
            {% else %}
                Author has been deleted
            {% endif %}
        </li>
      {% empty %}
        <li>No commissions created by you.</li>
      {% endfor %}
    </ul>

    <h2>Commissions You've Applied To</h2>
    <ul>
      {% for commission in applied_commissions %}
        <li><a href="{% url 'commissions:commission' commission.id %}">{{ commission.title }}</a></li>
      {% empty %}
        <li>You haven't applied to any commissions yet.</li>
      {% endfor %}
    </ul>
  {% endif %}

  <h2>All Commissions</h2>
  <ul>
    {% for commission in commissions %}
      <li>
        <a href="{% url 'commissions:commission' commission.id %}">{{ commission.title }}</a>
        - {{ commission.status }}
        {% if commission.author %}
          (Created by {{ commission.author.display_name }})
        {% else %}
          (Author has been deleted)
        {% endif %}
      </li>
    {% empty %}
      <li>No commissions found.</li>
    {% endfor %}
  </ul>

  {% if user.is_authenticated %}
    <p><a href="{% url 'commissions:commission_create' %}">Create a new Commission</a></p>
  {% endif %}
{% endblock %}
